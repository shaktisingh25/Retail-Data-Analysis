-------------------------------------------
Batch: 0
-------------------------------------------
+----------+-------+---------+----------+-----------+--------+---------+
|invoice_no|country|timestamp|total_cost|total_items|is_order|is_return|
+----------+-------+---------+----------+-----------+--------+---------+
+----------+-------+---------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 1
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132561342829|United Kingdom|2024-07-28 07:28:31|1.25      |1          |1       |0        |
|154132561342830|United Kingdom|2024-07-28 07:28:37|5.65      |5          |1       |0        |
|154132561342831|United Kingdom|2024-07-28 07:28:39|182.51    |125        |1       |0        |
|154132561342832|United Kingdom|2024-07-28 07:29:16|4.96      |1          |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 2
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132561342833|United Kingdom|2024-07-28 07:29:27|31.25     |25         |1       |0        |
|154132561342834|United Kingdom|2024-07-28 07:29:28|300.91    |194        |1       |0        |
|154132561342835|United Kingdom|2024-07-28 07:29:35|3.3       |2          |1       |0        |
|154132561342836|United Kingdom|2024-07-28 07:29:43|6.75      |1          |1       |0        |
|154132561342837|EIRE          |2024-07-28 07:29:49|-651.54   |126        |0       |1        |
|154132561342838|United Kingdom|2024-07-28 07:29:58|65.34     |38         |1       |0        |
|154132561342839|United Kingdom|2024-07-28 07:30:03|9.35      |11         |1       |0        |
|154132561342840|United Kingdom|2024-07-28 07:30:15|22.5      |6          |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 3
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132561342841|United Kingdom|2024-07-28 07:30:36|5.9       |2          |1       |0        |
|154132561342842|United Kingdom|2024-07-28 07:30:41|14.150001 |13         |1       |0        |
|154132561342843|United Kingdom|2024-07-28 07:30:51|1.7       |2          |1       |0        |
|154132561342844|United Kingdom|2024-07-28 07:31:00|2.95      |1          |1       |0        |
|154132561342845|United Kingdom|2024-07-28 07:31:03|14.1      |19         |1       |0        |
|154132561342846|United Kingdom|2024-07-28 07:31:10|675.24    |420        |1       |0        |
|154132561342847|United Kingdom|2024-07-28 07:31:22|18.03     |7          |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 4
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132561342848|United Kingdom|2024-07-28 07:31:29|148.46    |106        |1       |0        |
|154132561342849|United Kingdom|2024-07-28 07:31:34|4.25      |1          |1       |0        |
|154132561342850|United Kingdom|2024-07-28 07:31:38|110.31    |35         |1       |0        |
|154132561342851|United Kingdom|2024-07-28 07:31:45|1421.94   |643        |1       |0        |
|154132561342852|EIRE          |2024-07-28 07:31:49|26.44     |15         |1       |0        |
|154132561342853|United Kingdom|2024-07-28 07:32:06|183.41    |43         |1       |0        |
|154132561342854|United Kingdom|2024-07-28 07:32:09|5.04      |12         |1       |0        |
|154132561342855|Belgium       |2024-07-28 07:32:12|10.1      |4          |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 5
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132561342856|Spain         |2024-07-28 07:32:31|77.979996 |13         |1       |0        |
|154132561342857|United Kingdom|2024-07-28 07:32:35|43.5      |8          |1       |0        |
|154132561342858|United Kingdom|2024-07-28 07:32:37|805.94995 |101        |1       |0        |
|154132561342859|United Kingdom|2024-07-28 07:32:39|34.4      |31         |1       |0        |
|154132561342860|United Kingdom|2024-07-28 07:32:39|118.25    |27         |1       |0        |
|154132561342861|United Kingdom|2024-07-28 07:32:40|3.9       |2          |1       |0        |
|154132561342862|United Kingdom|2024-07-28 07:32:45|37.44     |16         |1       |0        |
|154132561342863|United Kingdom|2024-07-28 07:32:51|13.05     |5          |1       |0        |
|154132561342864|United Kingdom|2024-07-28 07:32:54|9.4800005 |12         |1       |0        |
|154132561342865|United Kingdom|2024-07-28 07:33:03|53.6      |8          |1       |0        |
|154132561342866|United Kingdom|2024-07-28 07:33:06|1.3       |2          |1       |0        |
|154132561342867|United Kingdom|2024-07-28 07:33:12|6.1       |6          |1       |0        |
|154132561342868|United Kingdom|2024-07-28 07:33:18|95.47     |21         |1       |0        |
|154132561342869|United Kingdom|2024-07-28 07:33:19|19.56     |12         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 6
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132561342870|United Kingdom|2024-07-28 07:33:35|-16.67    |14         |0       |1        |
|154132561342871|United Kingdom|2024-07-28 07:33:35|16.3      |10         |1       |0        |
|154132561342872|United Kingdom|2024-07-28 07:33:36|9.95      |1          |1       |0        |
|154132561342873|United Kingdom|2024-07-28 07:33:37|87.83     |29         |1       |0        |
|154132561342874|United Kingdom|2024-07-28 07:33:38|365.69    |151        |1       |0        |
|154132561342875|France        |2024-07-28 07:33:40|24.51     |17         |1       |0        |
|154132561342876|United Kingdom|2024-07-28 07:33:41|4.16      |2          |1       |0        |
|154132561342877|United Kingdom|2024-07-28 07:33:45|34.71     |8          |1       |0        |
|154132561342878|Germany       |2024-07-28 07:33:53|5.04      |12         |1       |0        |
|154132561342879|United Kingdom|2024-07-28 07:34:02|71.92     |15         |1       |0        |
|154132561342880|United Kingdom|2024-07-28 07:34:04|276.8     |132        |1       |0        |
|154132561342881|United Kingdom|2024-07-28 07:34:12|29.52     |12         |1       |0        |
|154132561342882|United Kingdom|2024-07-28 07:34:12|3.35      |3          |1       |0        |
|154132561342883|United Kingdom|2024-07-28 07:34:18|32.25     |15         |1       |0        |
|154132561342884|United Kingdom|2024-07-28 07:34:18|23.349998 |4          |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 7
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132561342885|United Kingdom|2024-07-28 07:34:22|1.65      |1          |1       |0        |
|154132561342886|United Kingdom|2024-07-28 07:34:26|21.02     |10         |1       |0        |
|154132561342887|United Kingdom|2024-07-28 07:34:31|180.04    |108        |1       |0        |
|154132561342888|Switzerland   |2024-07-28 07:34:34|354.31998 |92         |1       |0        |
|154132561342889|United Kingdom|2024-07-28 07:34:34|64.85     |23         |1       |0        |
|154132561342890|United Kingdom|2024-07-28 07:34:37|67.44     |12         |1       |0        |
|154132561342891|United Kingdom|2024-07-28 07:34:38|39.48     |12         |1       |0        |
|154132561342892|United Kingdom|2024-07-28 07:34:55|49.6      |24         |1       |0        |
|154132561342893|United Kingdom|2024-07-28 07:35:16|0.83      |1          |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 8
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132561342894|United Kingdom|2024-07-28 07:35:26|46.15     |8          |1       |0        |
|154132561342895|United Kingdom|2024-07-28 07:35:33|23.33     |2          |1       |0        |
|154132561342896|United Kingdom|2024-07-28 07:35:38|52.120003 |28         |1       |0        |
|154132561342897|United Kingdom|2024-07-28 07:35:42|71.71     |25         |1       |0        |
|154132561342898|EIRE          |2024-07-28 07:35:42|18.65     |5          |1       |0        |
|154132561342899|United Kingdom|2024-07-28 07:35:51|17.99     |13         |1       |0        |
|154132561342900|United Kingdom|2024-07-28 07:36:02|57.6      |84         |1       |0        |
|154132561342901|United Kingdom|2024-07-28 07:36:04|3.3400002 |2          |1       |0        |
|154132561342902|United Kingdom|2024-07-28 07:36:05|5.1       |2          |1       |0        |
|154132561342903|United Kingdom|2024-07-28 07:36:06|131.65    |66         |1       |0        |
|154132561342904|United Kingdom|2024-07-28 07:36:06|16.52     |4          |1       |0        |
|154132561342905|United Kingdom|2024-07-28 07:36:10|53.579998 |60         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 9
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132561342906|United Kingdom|2024-07-28 07:36:37|122.4     |144        |1       |0        |
|154132561342907|United Kingdom|2024-07-28 07:36:58|85.07     |53         |1       |0        |
|154132561342908|United Kingdom|2024-07-28 07:37:00|22.55     |7          |1       |0        |
|154132561342909|United Kingdom|2024-07-28 07:37:03|118.799995|24         |1       |0        |
|154132561342910|Germany       |2024-07-28 07:37:14|252.04    |93         |1       |0        |
|154132561342911|United Kingdom|2024-07-28 07:37:19|10.389999 |2          |1       |0        |
|154132561342912|United Kingdom|2024-07-28 07:37:25|81.64     |40         |1       |0        |
|154132561342913|United Kingdom|2024-07-28 07:37:27|54.6      |48         |1       |0        |
|154132561342914|United Kingdom|2024-07-28 07:37:32|425.68    |251        |1       |0        |
|154132561342915|United Kingdom|2024-07-28 07:37:35|1.95      |1          |1       |0        |
|154132561342916|United Kingdom|2024-07-28 07:37:41|52.239998 |30         |1       |0        |
|154132561342917|United Kingdom|2024-07-28 07:37:43|26.58     |28         |1       |0        |
|154132561342918|United Kingdom|2024-07-28 07:37:43|129.78    |31         |1       |0        |
|154132561342919|United Kingdom|2024-07-28 07:37:45|44.219997 |42         |1       |0        |
|154132561342920|Belgium       |2024-07-28 07:37:48|46.079998 |55         |1       |0        |
|154132561342921|United Kingdom|2024-07-28 07:37:51|149.29    |81         |1       |0        |
|154132561342922|United Kingdom|2024-07-28 07:37:54|104.34    |110        |1       |0        |
|154132561342923|United Kingdom|2024-07-28 07:38:00|32.579998 |15         |1       |0        |
|154132561342924|United Kingdom|2024-07-28 07:38:08|54.7      |32         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 10
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132561342925|United Kingdom|2024-07-28 07:38:21|29.6      |8          |1       |0        |
|154132561342926|United Kingdom|2024-07-28 07:38:23|2.1       |1          |1       |0        |
|154132561342927|United Kingdom|2024-07-28 07:38:25|156.2     |81         |1       |0        |
|154132561342928|United Kingdom|2024-07-28 07:38:28|5.79      |1          |1       |0        |
|154132561342929|United Kingdom|2024-07-28 07:38:31|67.96     |30         |1       |0        |
|154132561342930|United Kingdom|2024-07-28 07:38:32|458.18    |176        |1       |0        |
|154132561342931|United Kingdom|2024-07-28 07:38:42|22.19     |7          |1       |0        |
|154132561342932|United Kingdom|2024-07-28 07:38:44|7.5       |6          |1       |0        |
|154132561342933|United Kingdom|2024-07-28 07:38:48|59.260002 |16         |1       |0        |
|154132561342934|United Kingdom|2024-07-28 07:39:02|255.26    |602        |1       |0        |
|154132561342935|United Kingdom|2024-07-28 07:39:10|237.92    |114        |1       |0        |
|154132561342936|United Kingdom|2024-07-28 07:39:11|57.23     |19         |1       |0        |
|154132561342937|United Kingdom|2024-07-28 07:39:16|17.43     |15         |1       |0        |
|154132561342938|United Kingdom|2024-07-28 07:39:17|96.71     |43         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 11
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132561342939|United Kingdom|2024-07-28 07:39:21|-33.75    |8          |0       |1        |
|154132561342940|United Kingdom|2024-07-28 07:39:56|260.97    |110        |1       |0        |
|154132561342941|United Kingdom|2024-07-28 07:39:58|3.04      |16         |1       |0        |
|154132561342942|United Kingdom|2024-07-28 07:39:59|12.45     |2          |1       |0        |
|154132561342943|United Kingdom|2024-07-28 07:40:11|367.71    |35         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 12
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132561342944|United Kingdom|2024-07-28 07:40:16|1351.41   |341        |1       |0        |
|154132561342945|United Kingdom|2024-07-28 07:40:18|143.66    |60         |1       |0        |
|154132561342946|United Kingdom|2024-07-28 07:40:37|27.95     |12         |1       |0        |
|154132561342947|United Kingdom|2024-07-28 07:40:46|90.53     |37         |1       |0        |
|154132561342948|United Kingdom|2024-07-28 07:40:52|14.95     |1          |1       |0        |
|154132561342949|United Kingdom|2024-07-28 07:40:58|2.55      |1          |1       |0        |
|154132561342950|United Kingdom|2024-07-28 07:41:00|20.1      |14         |1       |0        |
|154132561342951|Spain         |2024-07-28 07:41:02|57.81     |21         |1       |0        |
|154132561342952|United Kingdom|2024-07-28 07:41:03|5.9       |2          |1       |0        |
|154132561342953|United Kingdom|2024-07-28 07:41:16|0.83      |1          |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 13
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132561342954|United Kingdom|2024-07-28 07:41:16|17.6      |4          |1       |0        |
|154132561342955|United Kingdom|2024-07-28 07:41:16|40.4      |26         |1       |0        |
|154132561342956|United Kingdom|2024-07-28 07:41:25|36.440002 |19         |1       |0        |
|154132561342957|United Kingdom|2024-07-28 07:41:27|38.14     |11         |1       |0        |
|154132561342958|United Kingdom|2024-07-28 07:41:34|187.72    |103        |1       |0        |
|154132561342959|United Kingdom|2024-07-28 07:41:38|-106.78   |26         |0       |1        |
|154132561342960|United Kingdom|2024-07-28 07:41:39|57.61     |46         |1       |0        |
|154132561342961|United Kingdom|2024-07-28 07:41:41|82.600006 |20         |1       |0        |
|154132561342962|Germany       |2024-07-28 07:41:42|29.85     |17         |1       |0        |
|154132561342963|United Kingdom|2024-07-28 07:41:57|121.87    |37         |1       |0        |
|154132561342964|United Kingdom|2024-07-28 07:41:58|6.5       |6          |1       |0        |
|154132561342965|United Kingdom|2024-07-28 07:42:09|20.0      |12         |1       |0        |
|154132561342966|United Kingdom|2024-07-28 07:42:12|18.78     |21         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 14
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132561342967|United Kingdom|2024-07-28 07:42:19|4.89      |3          |1       |0        |
|154132561342968|United Kingdom|2024-07-28 07:42:20|364.52    |154        |1       |0        |
|154132561342969|United Kingdom|2024-07-28 07:42:21|1.9499999 |3          |1       |0        |
|154132561342970|United Kingdom|2024-07-28 07:42:22|1.65      |1          |1       |0        |
|154132561342971|United Kingdom|2024-07-28 07:42:36|47.13     |27         |1       |0        |
|154132561342972|United Kingdom|2024-07-28 07:42:49|16.95     |25         |1       |0        |
|154132561342973|United Kingdom|2024-07-28 07:43:07|32.16     |4          |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

Traceback (most recent call last):
  File "/home/hadoop/spark-streaming.py", line 146, in <module>
    order_batch.awaitTermination()
  File "/usr/lib/spark/python/lib/pyspark.zip/pyspark/sql/streaming.py", line 103, in awaitTermination
  File "/usr/lib/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1255, in __call__
  File "/usr/lib/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 985, in send_command
  File "/usr/lib/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1152, in send_command
  File "/usr/lib64/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/usr/lib/spark/python/lib/pyspark.zip/pyspark/context.py", line 278, in signal_handler
KeyboardInterrupt
